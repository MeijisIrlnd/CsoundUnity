<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>CsoundUnity by rorywalsh</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">CsoundUnity</h1>
      <h2 class="project-tagline">Csound wrapper for Unity3d</h2>
      <a href="https://github.com/rorywalsh/CsoundUnity" class="btn">View on GitHub</a>
      <a href="https://github.com/rorywalsh/CsoundUnity/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/rorywalsh/CsoundUnity/releases/download/v2.0/CsoundUnityWin.unitypackage" class="btn">Download Windows pacakge(x64)</a>
      <a href="https://https://github.com/rorywalsh/CsoundUnity/releases/download/v2.0/CsoundUnityOSX.unitypackage" class="btn">Download OSX pacakge</a>
      <a href="docs.html" class="btn">Docs</a>
    </section> 

    <section class="main-content">
      <p>


<h3>Documentation</h3>
<ul>
<li><a href="#installing">Installing</a></li>
<li><a href="#getting_started">Getting started</a></li>
<li><a href="#controlling_csound_from_unity">Controlling Csound from Unity</a></li>
<li><a href="#controlling_csound_from_unity_editor">Controlling Csound from the Unity Editor</a></li>
<li><a href="#reading_files_with_csound">Reading files with Csound</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
<p><a name="installing"></a></p>
<h2>Installing</h2>
<p>In order to use CsoundUnity you will need to install the packages available from the following links:</p>
<ul>
<li>
<p><a href=https://github.com/rorywalsh/CsoundUnity/releases>CsoundUnity</a></p>
</li>
</ul>
<p>To install the package, simply create a new Unity project, then go to Assets, Import Package, Custom package and select the CsoundUnity package for your platform. Then select 'Import All' and hit Ok.  The package comes with a simple scene that demonstrates how it can be used. If you installed CsoundUnity from the Assets Store, you will need to also install Csound. Information on this is given below in the <a href="#troubleshooting">troubleshooting</a> section.</p>

<p><a name="getting_started"></a></p>
<h2>Getting Started</h2>
<p>CsoundUnity is a simple component that can be added to any GameObject in a scene. To do so simple hit <strong>AddComponent</strong> in the inspector, then click <strong>Audio</strong> and add <strong>CsoundUnity</strong>.</p>
<p><img src="http://rorywalsh.github.io/CsoundUnity/images/addCsoundUnityComponent.gif" alt="Add CsoundUnity"/></p>
<p>CsoundUnity requires the presence of an AudioSource. If the GameObject you are trying to attach a CsoundUnity component to does not already have an AudioSource attached, one will be added automatically. </p>
<p>Once a CsoundUnity component has been added to a GameObject, you will need to attach a Csound file to it. Csound files <em>MUST</em> be placed somewhere in the Assets/Scripts folder. In the sample CsoundUnity package they are kept in a sub-folder within Assets/Scripts called CsoundFiles. This is not required, but may help to better organise your assets. To attach a Csound file to a CsoundUnity component, simply drag it from the Assets folder to the 'Drag and Drop Csound file here' field in the CsoundUnity component inspector. When your game starts, Csound will feed audio from its output buffer into the AudioSource. Any audio produced by Csound can be accessed through the AudioSource component. This is currently restricted to stereo files, but will work for any amount of channels. See <a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L130-L161"><strong>CsoundUnity::processBlock()</strong></a> </p>
<p><img src="http://rorywalsh.github.io/CsoundUnity/images/addCsoundFile.gif" alt="Add Csound file"/></p>
<p>Your Csound files should always include the <strong>-n -d</strong> flags in the CsOptions section. </p>
<p><img src="http://rorywalsh.github.io/CsoundUnity/images/CsOptions.png" alt="CsOptions"/></p>
<p>This ensures Csound does not try to open any audio devices. This is left to entirely up to Unity. If you fail to disable writing of audio from Csound to a realtime audio output device, both Csound and Unity will try to access the computer's audio devices at the same time. This will inevitably lead to problems. Any Csound instruments that are set to start after 0 seconds will begin to play as soon as you enter 'Play' mode in Unity. This can be seen in several of the instruments provided in the sample package. You can also start an instrument to play at any time using the <a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L252-L256"><strong>CsoundUnity::sendScoreEvent()</strong></a> method. </p>

<p><a name=controlling_csound_from_unity></a></p>
<h2>Controlling Csound from Unity</h2>
<p>Once you have attached a Csound file to a CsoundUnity componet, you may wish to control aspects of that instrument in realtime. To do this, you can use Csound's channel system. Csound allows data to be sent and received over its channel system. To access data in Csound, one must use the <strong>chnget</strong> opcode. In the following code example, we access data being sent from Unity to Csoud on a channel named <em>speed</em>. The variable kSpeed will constantly update according to the value stored on the channel named <em>speed</em>. </p>
<p><img src="http://rorywalsh.github.io/CsoundUnity/images/chnget.png" alt="chnget"/></p>
<p>In order to send data from Unity to Csound we must use the <a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L223-L227"><strong>CsoundUnity::setChannel(string channel, double value)</strong></a> method. Before calling any CsoundUnity methods, one must first access the component using the <strong>GetComponent()</strong> method. This can be seen the simple script that follows. One usually calls GetComponent() in your script's <strong>Awake()</strong> method. Once the CsoundUnity componet has been accessed, any of its member method can be called. In the <strong>update()</strong> method of the script below,     </p>
<p><img src="http://rorywalsh.github.io/CsoundUnity/images/setChannel.png" alt="setChannel"/></p>
<p>Channels can also be used to trigger one-shot instruments to play. The simplest way to achieve this is to use Csound's <strong>event</strong> opcode. In the following Csound code example the <strong>JUMP</strong> instrument will be triggered whenever the value of the <em>"jump"</em> channel changes. Instrument <strong>TriggerInstrument</strong> will start as soon as the game does. Its job is to listen for changes to the values stored on the channel named <em>"jump"</em>. When the channel value changes the variable <strong>kJumpButton</strong> will change, causing the <strong>changed</strong> opcode to output a 1. At this point the code contained within the <strong>if</strong> block will be triggered and the instrument named <strong>JUMP</strong> will be triggered to play for one second. </p>

<p><a name=controlling_csound_from_unity_editor></a></p>
<h2>Controlling Csound from the Unity Editor</h2>
<p>In order to control Csound instruments in standalone gameplay, you will need to use the methods described above. However, you can also control Csound channels using the Unity Editor while you are developing your game's sounds. To do so, you must provide a short <CsoundUnity></CsoundUnity> descriptor at the top of your Csound files describing the channels that are needed. This simple descriptor section uses a single line of code to describe each channel. Each line starts with the given channel's controller type and is then followed by combination of other identifiers such as channel(), text(), and range(). The following descriptor sets up 3 channel controllers. A slider, a button and a checkbox(toggle).</p>
<p><img src="http://rorywalsh.github.io/CsoundUnity/images/csoundUnityDescriptor.png" alt="csoundUnitySection"/></p>
<p>Each control MUST specify a channel. The range() identifier must be used if the controller type is a slider. The text() identifier can be used to display unique text beside a control but it is not required. If it is left out, the channel() name will be used as the control's label. The caption() identifier, used with form, is used to display some simple help text to the user.</p>
<p>When a Csound file which contains a valid <CsoundUnity> section is dragged to a CsoundUnity component, Unity will generate controls for each channel. These controls can be tweaked when your game is running. Each time a control is modified, its value is sent to Csound from Unity on the associated channel. In this way it works the same as the method above, only we don't have to code anything in order to test our sound. For now, CsoundUnity support only three types of controller, slider, checkbox(toggle) and button. </p>
<p><img src="http://rorywalsh.github.io/CsoundUnity/images/csoundUnityDescriptor.gif" alt="csoundUnitySection"/></p>

<p><a name=reading_files_with_csound></a></p>
<h2>Reading files with Csound</h2>
<p>If you wish to read files with Csound through its file reading opcodes, i.e, diskin, fink, etc, you should create a folder in your Assets folder called CsoundFiles. It's good practice to place all files Csound needs access to in this folder. You can access the path for this folder in your Csound code by using the <em>chnget</em> opcode. You will need to pass it the channel name "CsoundFiles". For example, the following code will read a file called mix from the CsoundFile directory. 


<p><img src="http://rorywalsh.github.io/CsoundUnity/images/readFile.png" alt="readFIle"/></p>


When you build a standalone version of your game all files in the Assets/CsoundFiles folder will be copied to the StreamingAssets folder so that Unity does not try to compress and reformat them. The 'CsoundFiles' channel will also be updated so your Csound code will still work. CsoundUnity also provides the channels for accessing the Assets/StreamingAssets folder, and the Assets/Audio folder.  

<br>
SStreamingAssets chnget "StreamingAssets" ;return the path to the streaming assets folder
SAudio chnget "AudioPath" ; returns the path to the audio assets folder



<p><a name=troubleshooting></a></p>
<h2>Troubleshooting</h2>
<p>If you installed CsoundUnity from the Assets Store and don't already have Csound, you should simply install one of the following packages instead:</p>
<ul>
<li>
<p><a href="https://github.com/rorywalsh/CsoundUnity/releases/download/v2.0/CsoundUnityWin.unitypackage">CsoundUnity for Windows</a> </p>
</li>
<li>
<p><a href="https://github.com/rorywalsh/CsoundUnity/releases/download/v2.0/CsoundUnityOSX.unitypackage">CsoundUnity for OSX</a></p>
</li>
</ul>
<p>On Windows, the csound64.dll must reside in the SmtreaingAssets folder. If it is not there, CsoundUnity will display an error. One OSX, the CsoundLib64.framework must reside in the StreamingAssets folder. If it is not, CsoundUnity will display an error. </p>
<p>If you have Csound installed you can simple place it to the correct location, although it is far easier to use the package provided. They will not have any effect on any existing Csound installation. </p>
<p>If your game crashes at any point, the best place to look for answers will be in the <a href="http://docs.unity3d.com/Manual/LogFiles.html">Editor Logs</a>. If you continue to have issues with CsoundUnity, please use the github <a href="https://github.com/rorywalsh/CsoundUnity/issues">Issue Tracker</a> to file an issue. </p>
<p><a name=reference></a></p>
<h2>Reference</h2>
<p>Below is a list of all the methods currently available in CsoundUnity. </p>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L220"><strong>public void setChannel(string channel, float val)</strong></a></p>
<ul>
<li>Sets a Csound channel. Used in connection with a chnget opcode in your Csound instrument.</li>
</ul>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L227"><strong>public void setStringChannel(string channel, string val)</strong></a></p>
<ul>
<li>Sets a string channel in Csound. Used in connection with a chnget opcode in your Csound instrument.</li>
</ul>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L249"><strong>public void sendScoreEvent(string scoreEvent)</strong></a></p>
<ul>
<li>Send a score event to Csound in the form of "i1 0 10 ...."</li>
</ul>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L234"><strong>public double getChannel(string channel)</strong></a></p>
<ul>
<li>Gets a Csound channel. Used in connection with a chnset opcode in your Csound instrument.</li>
</ul>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L242"><strong>public double getTableSample(int tableNumber, int index)</strong></a></p>
<ul>
<li>Retrieves a single sample from a Csound function table. </li>
</ul>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L195"><strong>public double get0dbfs()</strong></a></p>
<ul>
<li>Get 0dbfs</li>
</ul>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L163"><strong>public int performKsmps()</strong></a></p>
<ul>
<li>Processes a ksmps-sized block of samples</li>
</ul>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L107"><strong>public double getKr()</strong></a></p>
<ul>
<li>Returns the current control rate</li>
</ul>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L171"><strong>public uint getKsmps()</strong></a></p>
<ul>
<li>Get the current control rate</li>
</ul>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L127"><strong>public void processBlock(float[] samples, int numChannels)</strong></a></p>
<ul>
<li>Processes a block of samples</li>
</ul>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L187"><strong>public double getSample(int frame, int channel)</strong></a></p>
<ul>
<li>Get a sample from Csound's audio output buffer</li>
</ul>
<p><a href="https://github.com/rorywalsh/CsoundUnity/blob/master/CsoundUnityScripts/CsoundUnity.cs#L187"><strong>public void setSample(int frame, int channel, double sample)</strong></a></p>
<ul>
<li>Set a sample in Csound's input buffer (is known to cause problems! Please only use this method if absolutely needed). </li>
</ul>


        

      </p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/rorywalsh/CsoundUnity">Csoundunity</a> is maintained by <a href="https://github.com/rorywalsh">rorywalsh</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
